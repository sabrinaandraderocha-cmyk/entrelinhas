{% extends "base.html" %}
{% block title %}{{ e.title }} • Entrelinhas{% endblock %}

{% block content %}
  <div class="reading-wrap">
    <div class="entry-header">
      <div class="entry-title">
        <h1 class="film" style="font-size: 32px;">{{ e.title }}</h1>
        <div class="muted">
          {% if e.year %}{{ e.year }}{% endif %}
          {% if e.year and e.director %} • {% endif %}
          {% if e.director %}{{ e.director }}{% endif %}
        </div>
      </div>
      
      <div class="section-actions">
        <button class="btn secondary" onclick="document.body.classList.toggle('reading')">
          Modo leitura
        </button>
        <a href="{{ url_for('index') }}" class="btn secondary">Voltar</a>
      </div>
    </div>

    <div class="card" style="margin-top: 20px;">
      <div class="entry-meta">
        {% if e.rating %}
          <div class="pill" style="border-color: var(--accent); color: var(--accent);">
            ★ {{ e.rating }}/10
          </div>
        {% endif %}
        {% if e.keyword %}
          <div class="pill">{{ e.keyword }}</div>
        {% endif %}
      </div>

      <div class="divider"></div>

      <div class="prose">
        {% if e.reflection %}
          {{ e.reflection|replace('\n', '<br>')|safe }}
        {% else %}
          <p class="muted" style="font-style: italic;">Sem texto principal.</p>
        {% endif %}
      </div>

      {% if e.q1 or e.q2 or e.q3 or e.critique_link %}
        <div class="divider"></div>
        <div class="grid">
          {% if e.q1 %}
            <div class="prompt">
              <strong>A cena que ficou:</strong>
              <p>{{ e.q1 }}</p>
            </div>
          {% endif %}
          {% if e.q2 %}
            <div class="prompt">
              <strong>O personagem:</strong>
              <p>{{ e.q2 }}</p>
            </div>
          {% endif %}
          {% if e.q3 %}
            <div class="prompt">
              <strong>Lembrou de:</strong>
              <p>{{ e.q3 }}</p>
            </div>
          {% endif %}
          {% if e.critique_link %}
            <div class="prompt">
              <strong>Link salvo:</strong>
              <p>
                <a href="{{ e.critique_link }}" target="_blank" style="text-decoration: underline; color: var(--accent);">
                  Abrir link ↗
                </a>
              </p>
            </div>
          {% endif %}
        </div>
      {% endif %}

      <div class="divider"></div>

      <div class="row">
        <a href="{{ url_for('edit_entry', entry_id=e.id) }}" class="btn primary">
          Editar filme
        </a>

        <form action="{{ url_for('delete_entry', entry_id=e.id) }}" method="post" onsubmit="return confirm('Tem certeza?');">
          <button type="submit" class="btn danger">
            Excluir
          </button>
        </form>
      </div>

    </div>
  </div>
{% endblock %}
