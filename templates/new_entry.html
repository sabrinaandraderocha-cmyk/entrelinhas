{% extends "base.html" %}

{% block title %}
  {{ 'Editar' if editing else 'Novo' }} filme • Entrelinhas
{% endblock %}

{% block content %}
  <div class="section-title">
    <div>
      <h2>{{ 'Editar filme' if editing else 'Novo filme' }}</h2>
      <p class="muted">
        {{ 'Revisite o que ficou guardado.' if editing else 'Deixa os créditos passarem — e anota o que ficou.' }}
      </p>
    </div>
  </div>

  <form class="card" method="post">
    <div class="grid2">
      <div>
        <label>Título do filme *</label>
        <input 
          class="input" 
          name="title" 
          placeholder="Ex: Passagens" 
          value="{{ entry.title if entry else '' }}" 
          required
        >
      </div>
      <div>
        <label>Ano</label>
        <input 
          class="input" 
          name="year" 
          placeholder="Ex: 2023"
          value="{{ entry.year if entry else '' }}"
        >
      </div>
    </div>

    <div class="grid2">
      <div>
        <label>Direção</label>
        <input 
          class="input" 
          name="director" 
          placeholder="Ex: Ira Sachs"
          value="{{ entry.director if entry else '' }}"
        >
      </div>
      <div>
        <label>Uma palavra</label>
        <input 
          class="input" 
          name="keyword" 
          placeholder="Ex: culpa / desejo / luto"
          value="{{ entry.keyword if entry else '' }}"
        >
      </div>
    </div>

    <label style="margin-top:20px;">O que esse filme acendeu em você?</label>
    <textarea
      class="input"
      name="reflection"
      placeholder="Uma cena, um gesto, uma frase, um silêncio… o que te acompanhou depois?"
    >{{ entry.reflection if entry else '' }}</textarea>

    <div class="divider"></div>

    <label>Que nota você daria?</label>
    <input
      class="input"
      type="number"
      name="rating"
      min="1"
      max="10"
      step="1"
      placeholder="De 1 a 10"
      value="{{ entry.rating if entry and entry.rating else '' }}"
      style="max-width: 150px;" 
    >

    <div class="divider"></div>

    <div class="muted" style="margin-bottom:16px; font-size: 14px;">
      Detalhes que ficam (opcional)
    </div>

    <div class="grid">
      <div class="prompt">
        <div class="muted small" style="margin-bottom: 6px;">Qual cena ficou com você?</div>
        <input 
          class="input" 
          name="q1" 
          placeholder="Às vezes é só um instante"
          value="{{ entry.q1 if entry else '' }}"
        >
      </div>

      <div class="prompt">
        <div class="muted small" style="margin-bottom: 6px;">Qual personagem te marcou mais?</div>
        <input 
          class="input" 
          name="q2" 
          placeholder="Às vezes é um detalhe, não o arco inteiro"
          value="{{ entry.q2 if entry else '' }}"
        >
      </div>

      <div class="prompt">
        <div class="muted small" style="margin-bottom: 6px;">Lembrou outra obra?</div>
        <input 
          class="input" 
          name="q3" 
          placeholder="Um filme, uma música, um livro..."
          value="{{ entry.q3 if entry else '' }}"
        >
      </div>

      <div class="prompt">
        <div class="muted small" style="margin-bottom: 6px;">Link de referência (crítica/vídeo)</div>
        <input 
          class="input" 
          name="critique_link" 
          placeholder="Cole a URL aqui"
          value="{{ entry.critique_link if entry else '' }}"
        >
      </div>
    </div>

    <div class="row" style="margin-top: 24px;">
      <button class="btn primary" type="submit">
        {{ 'Salvar alterações' if editing else 'Guardar filme' }}
      </button>

      {% if editing %}
        <a class="btn secondary" href="{{ url_for('view_entry', entry_id=entry.id) }}">Cancelar</a>
      {% else %}
        <a class="btn secondary" href="{{ url_for('index') }}">Cancelar</a>
      {% endif %}
    </div>
  </form>
{% endblock %}
